<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script type="text/javascript" src="charts.js"></script>
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

  <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-analytics.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-firestore.js"></script>
  <script>
    // TODO: Replace the following with your app's Firebase project configuration
    // For Firebase JavaScript SDK v7.20.0 and later, `measurementId` is an optional field
    var firebaseConfig = {
        apiKey: "AIzaSyC4SdSclIpleOjYYNqLXR40gO-jh7Ne98c",
        authDomain: "vis-proj-3.firebaseapp.com",
        projectId: "vis-proj-3",
        storageBucket: "vis-proj-3.appspot.com",
        messagingSenderId: "159414294621",
        appId: "1:159414294621:web:c40e177c24ec2fb7ed95b4",
        measurementId: "G-1CQ107N56R"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
  </script>


    <div class="progress">
        <div>Page <span id="page"></span>/73</div>
        <progress value="25" max="73"></progress>
    </div>

    <div class="instruc">
        <p>In this experiment,</p>
        <p>you are asked to judge</p>
        <p>what is the percent of a smaller value to a larger value in several charts</p>
        <br>
        <p>We won't record any information from you except your answers.</p>
        <p>Click the 'agree' button to begin.</p>
        <br>
        <p>Thank you!</p>
    </div>
    <div class="submit_instruc">
        <button id="disagree"><a href="https://www.google.com/">DISAGREE</a></button>
        <button id="agree">AGREE</button>
    </div>
    <div class="svg" id="svg"></div>
    <div class="ps">
        <p>Two values are marked with dots</p>
        <p>What do you think the percent of the smaller value to the larger value?</p>
        <p>Please put your answer below</p>
        <p>e.g.If you think the smaller one is exactly a half of the bigger one.</p>
        <p>Please input '50'</p>
    </div>

    <div class="submit">
        <input type="number" autofocus max="100" min="0" autocomplete="off">
        <button id="Next">Next</button>
    </div>
    <div class="submit_part2">
        <input type="number" autofocus max="100" min="0" autocomplete="off">
        <button id="Next2">Next</button>
    </div>
    <div class="part1">
        <p>Part 1</p>
        <button id="continue1">Continue</button>
    </div>
    <div class="part2">
        <p>Part 2</p>
        <button id="continue2">Continue</button>
    </div>
    <div class="Thanks">
        <p>Thanks!</p>
        <button><a href="https://www.google.com/">Close</a></button>
    </div>
</body>
<script>
    var count = 0;
    var rightanswer;
    var progress = document.getElementsByTagName('progress')[0];
    var span_page = document.getElementById('page');
    var div_progress = document.getElementsByClassName('progress')[0];

    var input_part1 = document.getElementsByTagName('input')[0];
    var input_part2 = document.getElementsByTagName('input')[1];

    var button_agree = document.getElementById('agree');
    var div_instruc = document.getElementsByClassName('instruc')[0];
    var div_submit_instruc = document.getElementsByClassName('submit_instruc')[0];

    var divSvg = document.getElementById('svg');
    var div_ps = document.getElementsByClassName('ps')[0];
    //This is part 1 submit button
    var div_submit = document.getElementsByClassName('submit')[0];
    var button = document.getElementById('Next');
    //this is part 2 submit button
    var div_submit_part2 = document.getElementsByClassName('submit_part2')[0];
    var button_part2 = document.getElementById('Next2');

    var div_part1 = document.getElementsByClassName('part1')[0];
    var button_continue1 = document.getElementById('continue1');
    var div_part2 = document.getElementsByClassName('part2')[0];
    var button_continue2 = document.getElementById('continue2');

    var div_Thanks = document.getElementsByClassName('Thanks')[0];

    //create data for Type1 - type5
    var dataForChart = [];
    for (let i = 0; i < 10; i++) {
        let random1 = d3.randomInt(1, 11)();
        let random2;
        let data = [];
        do {
            random2 = d3.randomInt(1, 11)();
        } while (random2 == random1)
        data.push(random1);
        data.push(random2)
        data.push([1, 2, 3, 4, 5])
        dataForChart.push(data)
    }

    button_agree.addEventListener('click', function () {
        div_instruc.style.display = 'none';
        div_submit_instruc.style.display = 'none';

        div_part1.style.display = 'block';
        div_progress.style.display = 'block';

        count++;
        progress.value = count;
        span_page.innerHTML = count;
    })
    button_continue1.addEventListener('click', function () {
        div_part1.style.display = 'none';

        divSvg.style.display = 'block';
        div_ps.style.display = 'block';
        div_submit.style.display = 'block';
        let randomData = d3.randomInt(0, dataForChart.length)();
        let vbn = dataForChart[randomData];
        let randomDraw = d3.randomInt(0, vbn[2].length)();
        if (vbn[2][randomDraw] == 1) {
            type1(vbn[1], vbn[0]);
        } else if (vbn[2][randomDraw] == 2) {
            type2(vbn[1], vbn[0]);
        } else if (vbn[2][randomDraw] == 3) {
            type3(vbn[1], vbn[0]);
        } else if (vbn[2][randomDraw] == 4) {
            type4(vbn[1], vbn[0]);
        } else if (vbn[2][randomDraw] == 5) {
            type5(vbn[1], vbn[0]);
        }
        vbn[2].splice(randomDraw, 1);
        if (vbn[2].length == 0) {
            dataForChart.splice(randomData, 1)
        }

        count++;
        progress.value = count;
        span_page.innerHTML = count;

        console.log('rightanswer is' + rightanswer);
    })

    button.addEventListener('click', function () {
        divSvg.innerHTML = '';
        count++;
        progress.value = count;
        span_page.innerHTML = count;
        input_part1.value = '';

        if (dataForChart.length == 0) {
            divSvg.style.display = 'none';
            div_ps.style.display = 'none';
            div_submit.style.display = 'none';

            div_part2.style.display = 'block';
        } else {
            let randomData = d3.randomInt(0, dataForChart.length)();
            let vbn = dataForChart[randomData];
            let randomDraw = d3.randomInt(0, vbn[2].length)();
            if (vbn[2][randomDraw] == 1) {
                type1(vbn[1], vbn[0]);
            } else if (vbn[2][randomDraw] == 2) {
                type2(vbn[1], vbn[0]);
            } else if (vbn[2][randomDraw] == 3) {
                type3(vbn[1], vbn[0]);
            } else if (vbn[2][randomDraw] == 4) {
                type4(vbn[1], vbn[0]);
            } else if (vbn[2][randomDraw] == 5) {
                type5(vbn[1], vbn[0]);
            }
            vbn[2].splice(randomDraw, 1);
            if (vbn[2].length == 0) {
                dataForChart.splice(randomData, 1)
            }

            console.log('rightanswer is' + rightanswer);
        }
    })

    var piedata = createPieData();

    button_continue2.addEventListener('click', function () {
        div_part2.style.display = 'none';

        divSvg.style.display = 'block';
        div_ps.style.display = 'block';
        div_submit_part2.style.display = 'block';

        let randomData = d3.randomInt(0, piedata.length)();
        let vbn = piedata[randomData];
        let randomDraw = d3.randomInt(0, vbn[2].length)();
        if (vbn[2][randomDraw] == 1) {
            type6(vbn[0], vbn[1]);
        } else if (vbn[2][randomDraw] == 2) {
            type7(vbn[0], vbn[1]);
        }

        vbn[2].splice(randomDraw, 1);
        if (vbn[2].length == 0) {
            dataForChart.splice(randomData, 1)
        }

        count++;
        progress.value = count;
        span_page.innerHTML = count;

        console.log('rightanswer is' + rightanswer);
    })

    button_part2.addEventListener('click', function () {
        divSvg.innerHTML = '';
        count++;
        progress.value = count;
        span_page.innerHTML = count;

        input_part1.value = '';
        if (piedata.length == 0) {
            divSvg.style.display = 'none';
            div_ps.style.display = 'none';
            div_submit_part2.style.display = 'none';

            div_Thanks.style.display = 'block';
            // div_Thanks.style.display = 'block';
        } else {
            let randomData = d3.randomInt(0, piedata.length)();
            let vbn = piedata[randomData];
            let randomDraw = d3.randomInt(0, vbn[2].length)();
            if (vbn[2][randomDraw] == 1) {
                type6(vbn[0], vbn[1]);
            } else if (vbn[2][randomDraw] == 2) {
                type7(vbn[0], vbn[1]);
            }

            vbn[2].splice(randomDraw, 1);
            if (vbn[2].length == 0) {
                piedata.splice(randomData, 1)
            }

            console.log('rightanswer is' + rightanswer);
        }
    })


</script>
<script>
    function signInWithEmailPassword() {
  var email = "test@example.com";
  var password = "hunter2";
  // [START auth_signin_password]
  firebase.auth().signInWithEmailAndPassword(email, password)
    .then((userCredential) => {
      // Signed in
      var user = userCredential.user;
      // ...
    })
    .catch((error) => {
      var errorCode = error.code;
      var errorMessage = error.message;
    });
  // [END auth_signin_password]
}

function signUpWithEmailPassword() {
  var email = "test@example.com";
  var password = "hunter2";
  // [START auth_signup_password]
  firebase.auth().createUserWithEmailAndPassword(email, password)
    .then((userCredential) => {
      // Signed in 
      var user = userCredential.user;
      // ...
    })
    .catch((error) => {
      var errorCode = error.code;
      var errorMessage = error.message;
      // ..
    });
  // [END auth_signup_password]
}

function sendEmailVerification() {
  // [START auth_send_email_verification]
  firebase.auth().currentUser.sendEmailVerification()
    .then(() => {
      // Email verification sent!
      // ...
    });
  // [END auth_send_email_verification]
}

function sendPasswordReset() {
  const email = "sam@example.com";
  // [START auth_send_password_reset]
  firebase.auth().sendPasswordResetEmail(email)
    .then(() => {
      // Password reset email sent!
      // ..
    })
    .catch((error) => {
      var errorCode = error.code;
      var errorMessage = error.message;
      // ..
    });
  // [END auth_send_password_reset]
}
</script>
<script>
    function makeGoogleCredential(googleUser) {
  // [START auth_make_google_credential]
  var credential = firebase.auth.GoogleAuthProvider.credential(
    googleUser.getAuthResponse().id_token);
  // [END auth_make_google_credential]
}

function makeFacebookCredential(response) {
  // [START auth_make_facebook_credential]
  var credential = firebase.auth.FacebookAuthProvider.credential(
    response.authResponse.accessToken);
  // [END auth_make_facebook_credential]
}

function makeEmailCredential(email, password) {
  // [START auth_make_email_credential]
  var credential = firebase.auth.EmailAuthProvider.credential(email, password);
  // [END auth_make_email_credential]
}

function signOut() {
  // [START auth_sign_out]
  firebase.auth().signOut().then(() => {
    // Sign-out successful.
  }).catch((error) => {
    // An error happened.
  });
  // [END auth_sign_out]
}

function authStateListener() {
  // [START auth_state_listener]
  firebase.auth().onAuthStateChanged((user) => {
    if (user) {
      // User is signed in, see docs for a list of available properties
      // https://firebase.google.com/docs/reference/js/firebase.User
      var uid = user.uid;
      // ...
    } else {
      // User is signed out
      // ...
    }
  });
  // [END auth_state_listener]
}

function setLanguageCode() {
  // [START auth_set_language_code]
  firebase.auth().languageCode = 'it';
  // To apply the default browser preference instead of explicitly setting it.
  // firebase.auth().useDeviceLanguage();
  // [END auth_set_language_code]
}

function authWithCredential(credential) {
  // [START auth_signin_credential]
  // Sign in with the credential from the user.
  firebase.auth()
    .signInWithCredential(credential)
    .then((result) => {
      // Signed in 
      // ...
    })
    .catch((error) => {
      // Handle Errors here.
      const errorCode = error.code;
      const errorMessage = error.message;
      // The email of the user's account used.
      const email = error.email;
      // ...
    });
  // [END auth_signin_credential]
}

function signInRedirect(provider) {
  // [START auth_signin_redirect]
  firebase.auth().signInWithRedirect(provider);
  // [END auth_signin_redirect]
}
</script>

</html>